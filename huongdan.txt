# ğŸ“˜ HÆ¯á»šNG DáºªN NHANH - TERRAFORM EKS PROJECT

âš ï¸ **CHÃš Ã**: File nÃ y chá»‰ Ä‘á»ƒ tham kháº£o nhanh. Xem chi tiáº¿t Ä‘áº§y Ä‘á»§ táº¡i **README.md**

## ğŸš€ QUICK START

### BÆ°á»›c 1: Chuáº©n bá»‹ mÃ´i trÆ°á»ng
```bash
# CÃ i Ä‘áº·t cÃ¡c tools cáº§n thiáº¿t:
# - Terraform (>= 1.5.0)
# - AWS CLI
# - kubectl
# - Helm (>= 3.0)
# - Git & Git Bash (Windows)

# Cáº¥u hÃ¬nh AWS
aws configure
```

### BÆ°á»›c 2: Deploy Infrastructure
```bash
cd environments/dev
terraform init
terraform apply
```

### BÆ°á»›c 3: Káº¿t ná»‘i Cluster
```bash
# Má»Ÿ Git Bash
aws eks update-kubeconfig --name doan-cluster-dev --region ap-southeast-1

# Verify
kubectl get nodes
```

---

## ğŸŒ TRUY Cáº¬P CÃC Dá»ŠCH Vá»¤

### 1ï¸âƒ£ ArgoCD
```bash
kubectl port-forward svc/argocd-server 30081:80 -n argo

# Láº¥y password:
kubectl -n argo get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d

# URL: http://localhost:30081
# Username: admin
```

### 2ï¸âƒ£ Jenkins
```bash
kubectl port-forward svc/jenkins 30808:8080 -n jenkins

# Láº¥y password:
kubectl -n jenkins get secret jenkins -o jsonpath="{.data.jenkins-admin-password}" | base64 -d && echo

# URL: http://localhost:30808
# Username: admin
```

**Cáº¥u hÃ¬nh Jenkins:**

Plugins cáº§n cÃ i:
- Kubernetes
- Pipeline
- Git
- Configuration as Code Plugin
- SonarQube Scanner
- GitHub Branch Source
- Generic Webhook Trigger

Credentials cáº§n thÃªm:
- `aws-credentials`: AWS Access Key & Secret
- `github-token`: GitHub Token
- `dockerhub-credentials`: DockerHub login

**Jenkins Pipeline:**
- TÃªn: `terraform-pipeline`
- Repo: https://github.com/MeetingTeam/terraform
- Script: Jenkinsfile
- Parameter: ENV (dev/prod)
- Trigger: GitHub webhook

---

## ğŸ”’ VAULT SETUP

```bash
# Copy files vÃ o vault pod
kubectl -n vault cp ./vault-config/. vault-0:/home/vault

# Exec vÃ o pod
kubectl exec -it vault-0 -n vault -- sh

# Initialize (chá»‰ 1 láº§n!)
vault operator init

# âš ï¸ LÆ¯U Láº I Unseal Keys vÃ  Root Token!
# Unseal Key 1: [SAVE]
# Unseal Key 2: [SAVE]
# Unseal Key 3: [SAVE]
# Unseal Key 4: [SAVE]
# Unseal Key 5: [SAVE]
# Initial Root Token: [SAVE]

# Unseal (cáº§n 3/5 keys)
vault operator unseal [KEY_1]
vault operator unseal [KEY_2]
vault operator unseal [KEY_3]

# Run setup script (náº¿u cÃ³)
sh vault-install.sh
```

---

## ğŸ”‘ K8S SECRETS

```bash
# Apply credentials cho ArgoCD pull private repo
kubectl apply -f k8s-repo-credentials.yaml
```

---

## ğŸ§¹ CLEANUP

### âš ï¸ QUAN TRá»ŒNG: XÃ³a theo thá»© tá»±!

**BÆ°á»›c 1: XÃ³a Kubernetes workloads**
```bash
kubectl delete all --all --all-namespaces
kubectl delete pvc --all --all-namespaces
```

**BÆ°á»›c 2: XÃ³a Load Balancers (Báº®T BUá»˜C)**
```bash
# List load balancers
aws elbv2 describe-load-balancers \
  --query 'LoadBalancers[?contains(LoadBalancerName, `k8s`)].LoadBalancerArn'

# Delete load balancers
aws elbv2 delete-load-balancer --load-balancer-arn <arn>

# List target groups
aws elbv2 describe-target-groups \
  --query 'TargetGroups[?contains(TargetGroupName, `k8s`)].TargetGroupArn'

# Delete target groups
aws elbv2 delete-target-group --target-group-arn <arn>
```

**BÆ°á»›c 3: Terraform Destroy**
```bash
cd environments/dev
terraform destroy
```

---

## ğŸ“š TÃ€I LIá»†U CHI TIáº¾T

âœ… **README.md** - HÆ°á»›ng dáº«n Ä‘áº§y Ä‘á»§ chi tiáº¿t
âœ… **environments/dev/README.md** - Development environment
âœ… **environments/prod/README.md** - Production environment

Xem thÃªm chi tiáº¿t vá»:
- Kiáº¿n trÃºc há»‡ thá»‘ng
- Cáº¥u trÃºc modules
- Troubleshooting
- Monitoring & Logging
- Security best practices
- Backup & Recovery

---

## ğŸ†˜ Cáº¦N TRá»¢ GIÃšP?

1. Äá»c [README.md](./README.md) trÆ°á»›c
2. Kiá»ƒm tra logs: `kubectl logs -f <pod> -n <namespace>`
3. Xem events: `kubectl get events -A --sort-by='.lastTimestamp'`
4. Táº¡o issue trÃªn GitHub

---

**ğŸ“Œ Ghi chÃº nhanh:**
- Post-install script tá»± Ä‘á»™ng cháº¡y sau terraform apply
- EFS Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng cho Jenkins cache (dev only)
- ArgoCD vÃ  applications Ä‘Æ°á»£c cÃ i tá»± Ä‘á»™ng
- Credentials pháº£i setup thá»§ cÃ´ng trong Jenkins UI